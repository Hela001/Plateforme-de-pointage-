<div class="card">
  <div class="card-body">
    <h4>Mot de passe oublié</h4>
    <div *ngIf="message" class="alert alert-info">{{ message }}</div>

    <form *ngIf="step === 1" (ngSubmit)="sendCode()">
      <input type="email" [(ngModel)]="email" name="email" placeholder="Votre email" class="form-control mb-3" required>
      <button class="btn btn-primary w-100">Envoyer le code</button>
    </form>
 <form *ngIf="step === 2" #resetForm="ngForm" (ngSubmit)="resetPassword()">

  <input
    type="text"
    [(ngModel)]="code"
    name="code"
    placeholder="Code reçu"
    class="form-control mb-2"
    required
    #codeInput="ngModel">
  <div *ngIf="codeInput.invalid && codeInput.touched" class="text-danger">
    Le code est requis.
  </div>

  <!-- Nouveau mot de passe -->
  <input
    type="password"
    [(ngModel)]="newPassword"
    name="newPassword"
    placeholder="Nouveau mot de passe"
    class="form-control mb-2"
    required
    minlength="6"
    #newPasswordInput="ngModel">
  <div *ngIf="newPasswordInput.invalid && newPasswordInput.touched" class="text-danger">
    Mot de passe requis (au moins 6 caractères).
  </div>

  <!-- Confirmation mot de passe -->
  <input
    type="password"
    [(ngModel)]="confirmPassword"
    name="confirmPassword"
    placeholder="Confirmez le mot de passe"
    class="form-control mb-3"
    required
    #confirmPasswordInput="ngModel">
  <div *ngIf="confirmPasswordInput.invalid && confirmPasswordInput.touched" class="text-danger">
    Confirmation requise.
  </div>

  <!-- Vérification correspondance -->
  <div *ngIf="passwordMismatch" class="alert alert-danger">
    Les mots de passe ne correspondent pas.
  </div>

  <button [disabled]="resetForm.invalid" class="btn btn-success w-100">
    Réinitialiser
  </button>
</form>
<div *ngIf="step === 3">
  <p>Mot de passe réinitialisé. Vous serez redirigé vers la page de connexion...</p>
  <p><a routerLink="/auth/signin">Cliquez ici si la redirection ne se fait pas</a>.</p>
</div>

  </div>
</div>
